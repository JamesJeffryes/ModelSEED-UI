
<div ng-if="data">
    <div class="table-controls">
        <div class="table-controls"  layout="row">
            <md-input-container md-no-float flex="45">
                <md-icon class="material-icons">search</md-icon>
                <input ng-model="opts.query" type="text" placeholder="{{placeholder}}" class="query-input">
            </md-input-container>

            <md-progress-circular ng-if="loading"
                                  md-mode="indeterminate"
                                  class="table-loading"
                                  md-diameter="20">
            </md-progress-circular>

            <md-input-container pagination layout="row" layout-align="end center" flex>
                <span hide-sm>{{opts.offset+1}}-{{opts.offset + opts.limit}} of {{data.numFound}} results</span>
                <div ng-disabled="opts.offset == 0" class="btn btn-default btn-sm" ng-click="prev()">
                    <i class="fa fa-chevron-left"></i> prev
                </div>
                <div class="btn btn-default btn-sm" ng-click="next()">next
                    <i class="fa fa-chevron-right"></i>
                </div>
            </md-input-container>
        </div>
    </div>

    <table class="table table-striped table-bordered">
        <thead sortable>
            <tr>
                <th ng-repeat="h in header track by $index" ng-click="sortBy($event, h.key)">{{::h.label}}</th>
            </tr>
        </thead>

        <tr ng-repeat="item in (filtered = ( data | filter: opts.query | orderBy : opts.sort.field : opts.sort.desc)
                        | limitTo : opts.limit : opts.offset)">
            <td ng-repeat="h in header">

                <span ng-if="h.hasOwnProperty('newTab')">
                    <a ng-click="h.call($event, item[h.key])">{{::item[h.key].split('_')[0]}}[{{::item[h.key].split('_')[1]}}]</a>
                </span>

                <span ng-if="h.hasOwnProperty('formatter')"
                      ng-bind-html="h.formatter(item[h.key])"></span>

                <span ng-if="h.hasOwnProperty('newTabList')">
                    <span ng-repeat="x in item[h.key]">
                        <a ng-click="h.call($event, x)">{{x.split('_')[0]}}[{{::x.split('_')[1]}}]</a>
                        <span ng-if="$index < item[h.key].length-1">,</span>
                    </span>
                </span>

                <span ng-if="!h.hasOwnProperty('newTab') && !h.hasOwnProperty('formatter') && !h.hasOwnProperty('newTabList') ">
                    {{::item[h.key]}}
                </span>

            </td>
        </tr>

        <div ng-if="!loading && filtered.length == 0">
            No item found
        </div>
    </table>
</div>
<br>
<md-progress-circular ng-if="loading"
                      md-mode="indeterminate"
                      md-diameter="40">
</md-progress-circular>
