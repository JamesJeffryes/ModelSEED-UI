
<div ng-if="data">
    <div class="table-controls">
        <div layout="row" layout-align="start start" class="pull-left">
            <i class="fa fa-search query-opt"></i>

            <md-input-container md-no-float>
                <input ng-model="opts.query" type="text" placeholder="{{placeholder}}" class="query-input">
            </md-input-container>

            <md-progress-circular ng-if="loading"
                                  md-mode="indeterminate"
                                  class="pull-left"
                                  md-diameter="20">
            </md-progress-circular>
        </div>


        <div class="pull-right">
            <select ng-model="opts.limit" class="btn btn-default" type="number">
                <option>10</option>
                <option>100</option>
                <option>250</option>
            </select>

            <span pagination>
                <div ng-disabled="opts.offset == 0"
                     class="btn btn-default btn-sm" ng-click="prev()">
                    <i class="fa fa-chevron-left"></i> prev
                </div>
                <div ng-disabled="opts.offset+opts.limit > filtered.length"
                     class="btn btn-default btn-sm" ng-click="next()">next
                    <i class="fa fa-chevron-right"></i>
                </div>
            </span>
        </div>

        <div class="pull-right query-opt">
            {{opts.offset+1}}-{{opts.offset + opts.limit}} of {{filtered.length}} results
        </div>
    </div>


    <table class="table table-bordered table-hover">
        <thead sortable>
            <tr>
                <th>Edit</th>
                <th ng-repeat="h in header track by $index" ng-click="sortBy($event, h.key)">{{h.label}}</th>
            </tr>
        </thead>

        <tr ng-repeat="item in (filtered = ( data | filter: opts.query |  orderBy : opts.sort.field : opts.sort.desc) )                | limitTo : opts.limit : (opts.query ? 0 : opts.offset)" >
            <td>
                <button ng-click="editRxn($event, $index)"
                        class="btn btn-default btn-xs">Edit {{$index}} {{edit.index}}
                </button>
            </td>
            <td ng-repeat="h in header">{{item[h.key]}}</td>

            <td>
            <form ng-if="edit.index == $index" ng-submit="rename(selected.name, edit.name)">
                <td ng-repeat="h in header">
                    <input ng-if="!saving"
                           type="text"
                           ng-model="edit.name"
                           focus-on="editable"
                           placeholder="{{item[h.key]}}"
                           ng-blur="rename(selected.name, edit.name)" required>
                </td>
                <span ng-if="saving">saving...</span>
            </form>
        </td>

        </tr>

        <div ng-if="!loading && filtered.length == 0">
            No reaction found
        </div>
    </table>
</div>

<br>
<md-progress-circular ng-if="loading"
                      md-mode="indeterminate"
                      class="pull-left"
                      md-diameter="40">
</md-progress-circular>

