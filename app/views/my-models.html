

<div class="h2">My Models</div>
<hr class="no-margin">

<div class="table-controls">
    <div layout="row" layout-align="start start" class="pull-left">
        <i class="fa fa-search query-opt"></i>

        <md-input-container md-no-float>
            <input ng-model="opts.query" type="text" placeholder="Search models" class="query-input">
        </md-input-container>

        <md-progress-circular ng-if="loading"
                              md-mode="indeterminate"
                              class="pull-left"
                              md-diameter="20">
        </md-progress-circular>
    </div>


    <div class="pull-right">
        <span pagination>
            <div ng-disabled="opts.offset == 0"
                 class="btn btn-default btn-sm" ng-click="prev()">
                <i class="fa fa-chevron-left"></i> prev
            </div>
            <div ng-disabled="opts.offset+opts.limit > filtered.length"
                 class="btn btn-default btn-sm" ng-click="next()">next
                <i class="fa fa-chevron-right"></i>
            </div>
        </span>
    </div>

    <div class="pull-right query-opt">
        {{opts.offset+1}}-{{opts.offset + opts.limit}} of {{filtered.length}} models
    </div>
</div>



<table class="table">
    <thead sortable>
        <tr>
            <th></th>
            <th ng-click="sortBy($event, 'orgName')">Organism</th>
            <th ng-click="sortBy($event, 'name')">Name</th>
            <th ng-click="sortBy($event, 'rxnCount')">Rxns</th>
            <th ng-click="sortBy($event, 'cpdCount')">Cpds</th>
            <th>FBAs | GFs</th>
            <th ng-click="sortBy($event, 'timestamp')">Created</th>
        </tr>
    </thead>
    <tbody>
        <tr ng-repeat-start="item in (filtered = ( data | filter: opts.query
                                                  | orderBy : opts.sort.field : opts.sort.desc)
                                                  | limitTo : opts.limit : opts.offset)  | orderBy : '-timestamp'"
            ng-click="showFBAs(item)"
            class="table-hover">
            <td>
                <i ng-if="!item.loading && !item.relatedFBAs"
                   class="fa fa-caret-right"
                   style="opacity: 0.5;"></i>
                <i ng-if="item.relatedFBAs"
                   class="fa fa-caret-down"
                   style="opacity: 1.0;"></i>
                <img ng-if="item.loading"
                     src="img/ajax-loader.gif"
                     width="15" height="15"
                     style="position: absolute;"></img>
            </td>
            <td>
                {{::item.orgName}}
            </td>
            <td><a ui-sref="app.modelPage({path: item.path})">{{::item.name}}</a></td>
            <td>{{::item.rxnCount}}</td>
            <td>{{::item.cpdCount}}</td>
            <td>
                <span class="badge label-fba pull-left">
                    <md-tooltip>Number of FBAs</md-tooltip>{{::item.fbaCount}}
                </span>

                <span class="badge label-gapfill pull-right">
                    <md-tooltip>Number of Gapfill Solutions</md-tooltip>
                    {{::item.gapfillCount}}
                </span>
            </td>
            <td>--</td>
        </tr>

        <tr ng-if="item.relatedFBAs || item.relatedGapfills" ng-repeat-end>
            <td colspan="6" style="padding-left: 30px;">

                <md-tabs class="my-models-tabs" md-selected="tabs.selectedIndex" md-no-ink md-dynamic-height="false">
                    <md-tab label="FBA Simulations ({{item.fbaCount}})">

                        <md-tab-body>
                            <ng-include src="'app/views/lists/expanded-fbas.html'">
                        </md-tab-body>
                    </md-tab>

                    <md-tab label="Gapfills ({{item.gapfillCount}})">
                        <md-tab-body>
                            <ng-include src="'app/views/lists/expanded-gapfills.html'">
                        </md-tab-body>
                    </md-tab>
                </md-tabs>
            </td>
        </tr>
        <!--
        <tr ng-if="item.relatedGapfills" ng-repeat-end>
            <td colspan="6">
                <ng-include src="'app/views/lists/expanded-gapfills.html'">
            </td>
        </tr>
        -->
    </tbody>
</table>

<!--
<md-progress-circular ng-if="loading"
                      md-mode="indeterminate"
                      md-diameter="40">
</md-progress-circular>
-->
