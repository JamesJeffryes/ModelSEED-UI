
<div layout="row">
    <div flex class="h2">
        {{filters.myGenomes ? 'My' : 'Public'}} Genomes
        <br><small class="help-text">Select a genome from below to reconstruct</small>
    </div>

    <div flex style="margin-top: 20px;">
        <md-switch md-no-ink
                   ng-model="filters.myGenomes"
                   aria-label="view my genomes"
                   ng-click="toggleMyGenomes()">
            View my genomes
        </md-switch>
    </div>
</div>
<hr class="no-margin">


<div class="table-controls">
    <div layout="row" layout-align="start start" class="pull-left">

        <div class="btn-group table-settings">
            <button ng-click="showMenu()" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                <i class="glyphicon glyphicon-cog"></i> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-visible table-settings">
                <li ng-repeat="item in columns">
                    <div ng-click="toggle(item.prop, opts.visible)">
                      <i class="fa {{exists(item.prop, opts.visible) ? 'fa-check-square-o' : 'fa-square-o'}}"></i>{{item.label}}
                    </div>
                </li>
            </ul>
        </div>


        <i class="fa fa-search query-opt"></i>

        <md-input-container md-no-float>
            <input ng-model="opts.query" type="text" placeholder="Search PATRIC genomes" class="query-input">
        </md-input-container>

    </div>
    <md-progress-circular ng-if="loading"
                          md-mode="indeterminate"
                          class="table-loading pull-left"
                          md-diameter="20">
    </md-progress-circular>


    <div class="pull-right">
        <!--
        <select ng-model="opts.limit" class="btn btn-default">
            <option>25</option>
            <option>100</option>
            <option>250</option>
        </select>-->

        <span pagination>
            <div ng-disabled="opts.offset == 0" class="btn btn-default btn-sm" ng-click="prev()">
                <i class="fa fa-chevron-left"></i> prev
            </div>
            <div class="btn btn-default btn-sm" ng-click="next()">next
                <i class="fa fa-chevron-right"></i>
            </div>
        </span>
    </div>

    <div class="pull-right query-opt">
        {{opts.offset+1}}-{{opts.offset+opts.limit}} of {{genomes.numFound}} results
    </div>

    <!--
    <div>
        <md-button md-no-ink
            class="md-primary md-raised btn-reconstruct"
            ng-if="selected"
            ng-click="reconstruct($event, selected)">
            Reconstruct
        </md-button>
    </div>
    -->

</div>

<table class="table">
    <thead sortable>
        <tr>
            <th></th>
            <th ng-repeat="h in opts.visible" ng-click="sortBy($event,h)">
                {{getLabel(h)}}
            </th>
        </tr>
    </thead>

    <tbody>
        <tr ng-repeat="g in genomes.docs"
            ng-click="reconstruct($event, g)"
            class="table-hover">

            <td>
                <i class="fa {{selected.genome_id == g.genome_id ? 'fa-circle' : 'fa-circle-o'}}"></i>
            </td>
            <td ng-repeat="col in opts.visible">
                <a ng-if="col == 'genome_name'" href="https://www.patricbrc.org/portal/portal/patric/Genome?cType=genome&cId={{g['genome_id']}}" target="_blank">{{g[col]}}</a>
                <span ng-if="col != 'genome_name'">{{g[col]}}</span>
            </td>

            <td ng-if="genomes.docs == 0 && !loading">No genome found</td>
        </tr>
    </tbody>
</table>
